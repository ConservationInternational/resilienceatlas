# Example .env file for STAGING environment (frontend + backend)
# This file shows the environment variables needed for EC2 deployment (staging environment)
# Copy to the project root as .env.staging and update with your actual values

#=============================================================================
# STAGING ENVIRONMENT VARIABLES (FRONTEND + BACKEND COMBINED)
# These variables are used by Docker Compose during EC2 deployment via CodeDeploy
#=============================================================================

# Staging database configuration (uses containerized PostgreSQL)
STAGING_DB_PASSWORD=your_secure_staging_database_password
STAGING_SECRET_KEY_BASE=your_128_character_random_secret_key_base_for_rails_sessions_and_cookies_staging_environment_use_rails_secret_to_generate
STAGING_DEVISE_KEY=your_128_character_random_devise_key_for_authentication_staging_environment_use_rails_secret_to_generate

# External service API keys for staging
SPARKPOST_API_KEY=your_sparkpost_staging_api_key_for_email_services
RESILIENCE_API_KEY=your_resilience_staging_api_key

# Application URLs
STAGING_BACKEND_URL=https://staging.resilienceatlas.org
STAGING_FRONTEND_URL=https://staging.resilienceatlas.org

# Frontend build-time variables (used as Docker build args)
NEXT_PUBLIC_API_HOST=https://staging.resilienceatlas.org
# Internal API host for server-side rendering (automatically set in docker-compose.staging.yml)
# This allows the Next.js server to reach the backend via Docker network
# Value is set to http://backend:3000 in docker-compose.staging.yml - no need to change
NEXT_PUBLIC_TRANSIFEX_TOKEN=your_transifex_staging_api_token_for_translation_services
NEXT_PUBLIC_TRANSIFEX_SECRET=your_transifex_staging_secret_key
NEXT_PUBLIC_GOOGLE_API_KEY=your_google_staging_api_key_for_maps_and_services
NEXT_PUBLIC_GOOGLE_ANALYTICS=UA-XXXXXXX-X

#=============================================================================
# DATABASE SYNC CONFIGURATION (for staging deployments)
#=============================================================================
# Production database URL - used to sync production data to staging
# Required if SYNC_PRODUCTION_DB is true
PRODUCTION_DATABASE_URL=postgresql://username:password@production-db-host:5432/resilienceatlas_production

# Set to "true" to sync production database to staging during deployment
# Set to "false" to skip database sync and keep existing staging data
SYNC_PRODUCTION_DB=true

# Set to "true" to anonymize sensitive data after syncing
# This will replace user emails with staging versions
ANONYMIZE_STAGING_DATA=false

#=============================================================================
# RAILS ENVIRONMENT VARIABLES (automatically set)
#=============================================================================
# These are set automatically by Docker Compose:
# RAILS_ENV=staging
# NODE_ENV=production
# PORT=3000 (frontend), 3001 (backend)

#=============================================================================
# USAGE INSTRUCTIONS
#=============================================================================
# 
# 1. Copy this file to the project root as .env.staging:
#    cp scripts/.env.staging.example .env.staging
# 
# 2. Replace all placeholder values with your actual staging credentials
# 
# 3. The file will be used by:
#    - Docker Compose during deployment (docker-compose.staging.yml)
#    - GitHub Actions CodeDeploy workflows (codedeploy_staging.yml)
#    - CodeDeploy lifecycle hook scripts
#
# Important Security Notes:
# - This file contains sensitive credentials - never commit to version control
# - Use different credentials for staging vs production
# - Generate Rails secrets with: rails secret (128-character strings)
# - Use strong, unique passwords and API keys
# - Regularly rotate API keys and secrets
#
# GitHub Actions Integration:
# The sensitive values from this file should also be added as GitHub repository secrets:
# - AWS_OIDC_ROLE_ARN (from setup_github_oidc.py)
# - DEPLOYMENT_S3_BUCKET (from setup_s3_bucket.py)
# - STAGING_DB_PASSWORD
# - STAGING_SECRET_KEY_BASE
# - STAGING_DEVISE_KEY
# - PRODUCTION_DATABASE_URL (for staging database sync)
# - SPARKPOST_API_KEY
# - RESILIENCE_API_KEY
# - NEXT_PUBLIC_TRANSIFEX_TOKEN
# - NEXT_PUBLIC_TRANSIFEX_SECRET
# - NEXT_PUBLIC_GOOGLE_API_KEY
# - NEXT_PUBLIC_GOOGLE_ANALYTICS
#=============================================================================

